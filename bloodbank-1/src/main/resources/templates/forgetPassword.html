<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- ... (your head section remains unchanged) ... -->
</head>
<body>
    <h2>Forget Password</h2>

    <!-- Form to enter email, send OTP, and reset password -->
    <form id="resetPassword" th:action="@{/resetPassword}" th:object="${detail}" method="post">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <!-- Button to trigger sending OTP -->
        <button type="button" onclick="sendOTP()">Send OTP</button>

        <!-- OTP input -->
        <label for="otp" id="otpLabel" style="display: none;">Enter OTP:</label>
        <input type="text" id="otp" name="otp" style="display: none;" required>

        <!-- New password input -->
        <label for="newPassword" id="passwordLabel" style="display: none;">New Password:</label>
        <input type="password" id="password" name="password" style="display: none;" required>

        <!-- Confirm password input -->
        <label for="confirmPassword" id="confirmPasswordLabel" style="display: none;">Confirm Password:</label>
        <input type="password" id="confirmPassword" name="confirmPassword" style="display: none;" oninput="validatePasswords()">

        <!-- Display error message if passwords do not match -->
        <p id="passwordError"></p>

        <!-- Button to submit the form -->
        <button type="submit" id="submitBtn" style="display: none;">Reset Password</button>
    </form>

    <!-- Link to go back to the login page -->
    <a th:href="@{/userLogin}" style="text-decoration: none;">Back to Login</a>

    <!-- Script to send OTP using AJAX and show/hide form elements -->
    <script>
        function sendOTP() {
            var email = document.getElementById('email').value;

            // Assuming you have an endpoint '/sendOTP/{email}' on the server to handle OTP requests
            fetch('/sendOTP/' + email, { method: 'POST' })
                .then(response => {
                    // Handle the response as needed
                    console.log('OTP Sent Successfully');
                })
                .catch(error => console.error('Error sending OTP:', error));

            // Show the OTP input and hide the email input and send OTP button
            document.getElementById('otpLabel').style.display = 'block';
            document.getElementById('otp').style.display = 'block';
            document.getElementById('passwordLabel').style.display = 'block';
            document.getElementById('password').style.display = 'block';
            document.getElementById('confirmPasswordLabel').style.display = 'block';
            document.getElementById('confirmPassword').style.display = 'block';
            
            // Show the submit button
            document.getElementById('submitBtn').style.display = 'block';
        }

        function validatePasswords() {
            var newPassword = document.getElementById('password').value;
            var confirmPassword = document.getElementById('confirmPassword').value;
            var errorLabel = document.getElementById('passwordError');

            // Check if passwords match
            if (newPassword !== confirmPassword) {
                errorLabel.textContent = 'Passwords do not match';
            } else {
                errorLabel.textContent = '';
            }
        }
    </script>
</body>
</html>
